<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="反思, 总结, 记录"><title>iOS状态栏颜色变更 | XuQ's Blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">iOS状态栏颜色变更</h1><a id="logo" href="/.">XuQ's Blog</a><p class="description">Stay Hungry Stay Foolish</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">iOS状态栏颜色变更</h1><div class="post-meta">Jun 25, 2017<span> | </span><span class="category"><a href="/categories/Swift/">Swift</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2017/06/25/2017-6-25-StatusBarColor/" href="/2017/06/25/2017-6-25-StatusBarColor/#comments" class="ds-thread-count"></a><div class="post-content"><p>iOS状态栏颜色变更    </p>
<ol>
<li>怎么改变状态栏颜色                </li>
<li>UINavigationController下的状态栏不起作用怎么办                    <a id="more"></a>    
</li>
</ol>
<p><a href="/assets/StatusBar.zip">演示项目下载</a></p>
<h2 id="实验"><a href="#实验" class="headerlink" title="实验:"></a>实验:</h2><p><strong>前提1: 没有导航栏的单控制器工程</strong><br><strong>前提2:    UIViewControllerBasedStatusBarAppearance = false</strong></p>
<p>实验一:<br>条件. 项目Target-General-StatusBarStyle-default<br><em>结果: <img src="/assets/UIViewControllerBasedStatusBarAppearance1.png" alt="状态栏黑色"></em>        </p>
<p>实验二:<br>条件: 项目Target-General-StatusBarStyle-lightContent<br><em>结果: <img src="/assets/UIViewControllerBasedStatusBarAppearance2.png" alt="状态栏白色"></em><br>实验三:<br>条件1: 项目Target-General-StatusBarStyle-lightContent<br>条件2: ViewController重写<code>preferredStatusBarStyle</code>方法        </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="keyword">var</span> preferredStatusBarStyle: UIStatusBarStyle &#123;</div><div class="line">    <span class="keyword">return</span> .<span class="keyword">default</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>结果:    结果同实验二, 状态栏并没有使用<code>preferredStatusBarStyle</code>显示黑色导航栏, 而是显示了白色状态栏</em></p>
<p>实验四:<br>条件1: 项目Target-General-StatusBarStyle-lightContent<br>条件2: 在ViewController的<code>ViewDidLoad</code>方法中添加代码</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">    <span class="type">UIApplication</span>.shared.setStatusBarStyle(.<span class="keyword">default</span>, animated: <span class="literal">true</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>结果:    结果同实验一, 显示黑色导航栏</em>        </p>
<p><strong>总结一</strong>: UIViewControllerBasedStatusBarAppearance=false时, 影响导航栏颜色的方式有两个:        </p>
<ol>
<li>info.plist中的UIStatusBarStyle(效果同项目Target-General-StatusBarStyle);         </li>
<li>通过配置UIApplication的setStatusBarStyle方法;</li>
</ol>
<p><strong>更改前提条件</strong><br><strong> 前提1: 没有导航栏的单控制器工程    </strong><br><strong> 前提2:    UIViewControllerBasedStatusBarAppearance = true </strong></p>
<p>实验五:<br>条件1: ViewController没有重写<code>preferredStatusBarStyle</code>方法<br>条件2: 项目Target-General-StatusBarStyle-lightContent(项目Target-General-StatusBarStyle-default)</p>
<p><em>结果: 状态栏一直为黑色</em></p>
<p>实验六:<br>条件: 重写ViewController 的<code>preferredStatusBarStyle</code>方法</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="keyword">var</span> preferredStatusBarStyle: UIStatusBarStyle &#123;</div><div class="line">    <span class="keyword">return</span> .<span class="keyword">default</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>结果: 状态栏黑色(设置项目Target-General-StatusBarStyle-lightContent不影响结果)</em></p>
<p>实验七:<br>条件: 重写ViewController 的<code>preferredStatusBarStyle</code>方法</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="keyword">var</span> preferredStatusBarStyle: UIStatusBarStyle &#123;</div><div class="line">    <span class="keyword">return</span> .lightContent</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>结果: 状态栏白色(设置项目Target-General-StatusBarStyle-default不影响结果)</em></p>
<p><strong>结果: UIViewControllerBasedStatusBarAppearance基于控制器的状态栏显示, 实际是由<code>preferredStatusBarStyle</code>返回值决定, 默认<code>default</code>为黑色文字, <code>lightContent</code>显示白色文字</strong></p>
<p>实验八:<br>将ViewController放入UINavigationController中<br><em>结果: <code>preferredStatusBarStyle</code>不起作用, <code>项目Target-General-StatusBarStyle-lightContent</code>也不起作用</em><br><em>结果分析: UINavigationController作为容器返回了它的preferredStatusBarStyle导致控制器设置无效</em></p>
<p>为了解决这个问题, 引入了一个自定义UINavigtaionController, 将Storyboard中的导航栏class替换为<code>CustomNavigationController</code>                        </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomNavigationController</span> : <span class="type">UINavigationController &#123;</span></span></div><div class="line">    <span class="keyword">override</span> <span class="keyword">var</span> preferredStatusBarStyle: UIStatusBarStyle &#123;</div><div class="line">        <span class="keyword">return</span> .lightContent</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>问题解决:<br><img src="/assets/UIViewControllerBasedStatusBarAppearance3.png" alt="状态栏白色"></p>
<p>但是又引入新问题了, 如果继承了导航栏, 如果需要变换导航栏风格,就需要经常的变换CustomNavigation的<code>preferredStatusBarStyle</code>, 为了解决这个问题, 苹果引入了<code>childViewControllerForStatusBarStyle</code>, 将CustomNavigationController更新如下, 则状态栏的会使用栈顶的ViewController的<code>preferredStatusBarStyle</code>:        </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomNavigationController</span> : <span class="type">UINavigationController &#123;</span></span></div><div class="line">    <span class="keyword">override</span> <span class="keyword">var</span> childViewControllerForStatusBarStyle: UIViewController? &#123;</div><div class="line">        <span class="keyword">return</span> self.topViewController</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>官方解释: If your container view controller derives its status bar style from one of its child view controllers, implement this method and return that child view controller. If you return nil or do not override this method, the status bar style for self is used. If the return value from this method changes, call the<br>setNeedsStatusBarAppearanceUpdate()<br> method.</p>
<p>翻译: 简而言之就是容器控制器需要根据子控制器来决定状态栏颜色, 实现该方法并返回对应的子控制器. 当返回nil或者没有实现该方法则使用默认的, 如果<code>childViewControllerForStatusBarStyle</code>的返回值更新了, 需要调用<code>setNeedsStatusBarAppearanceUpdate</code></p>
<p>到此关于状态栏变更的内容就讲完了, 主要分两种情况:        </p>
<ol>
<li>有导航栏, 并且希望中途修改导航栏颜色, 则自定义一个导航栏, 配置其<code>childViewControllerForStatusBarStyle</code>为栈顶控制器, 然后在需要自定义颜色的控制器中重写<code>preferredStatusBarStyle</code>方法        </li>
<li>没有导航栏并且希望中途改变导航栏颜色, 则直接重写<code>preferredStatusBarStyle</code>方法即可</li>
</ol>
<p><strong>备注</strong>        </p>
<ol>
<li><code>UIApplication.shared.setStatusBarStyle(.default, animated: true)</code>方法已过期, 不建议使用, 因此<code>UIViewControllerBasedStatusBarAppearance=false</code>也是不被推荐    </li>
<li>UIViewControllerBasedStatusBarAppearance默认为true, 所以在info.plist中不需要添加该配置        </li>
<li>总而言之: 忽略UIViewControllerBasedStatusBarAppearance, 使用<code>childViewControllerForStatusBarStyle</code>和<code>preferredStatusBarStyle</code>来管理状态栏颜色.</li>
</ol>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考:        "></a>参考:        </h2><p><a href="https://developer.apple.com/documentation/uikit/uiviewcontroller/1621433-childviewcontrollerforstatusbars" target="_blank" rel="external">https://developer.apple.com/documentation/uikit/uiviewcontroller/1621433-childviewcontrollerforstatusbars</a>        </p>
<p><a href="http://www.jianshu.com/p/0d4337b2e18a" target="_blank" rel="external">http://www.jianshu.com/p/0d4337b2e18a</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="https://antwork.github.io/2017/06/25/2017-6-25-StatusBarColor/" data-id="cj4cp015d002hpo1vk4ffs4re" class="article-share-link">分享到</a><div class="tags"><a href="/tags/swift/">swift</a><a href="/tags/UIViewControllerBasedStatusBarAppearance/">UIViewControllerBasedStatusBarAppearance</a><a href="/tags/childViewControllerForStatusBarStyle/">childViewControllerForStatusBarStyle</a><a href="/tags/状态栏/">状态栏</a></div><div class="post-nav"><a href="/2017/04/24/2017-4-24-Swift_usage1/" class="next">重构代码疑问之 as? as as!</a></div><div data-thread-key="2017/06/25/2017-6-25-StatusBarColor/" data-title="iOS状态栏颜色变更" data-url="https://antwork.github.io/2017/06/25/2017-6-25-StatusBarColor/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2017/06/25/2017-6-25-StatusBarColor/" data-title="iOS状态栏颜色变更" data-url="https://antwork.github.io/2017/06/25/2017-6-25-StatusBarColor/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://antwork.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Swift/">Swift</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/备忘/">备忘</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/文档/">文档</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/日志/">日志</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机/">计算机</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/sqlite3/" style="font-size: 15px;">sqlite3</a> <a href="/tags/博客/" style="font-size: 15px;">博客</a> <a href="/tags/markdown-翻译/" style="font-size: 15px;">markdown 翻译</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/ios/" style="font-size: 15px;">ios</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/json/" style="font-size: 15px;">json</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/ios-Icon-启动图-Default/" style="font-size: 15px;">ios, Icon, 启动图, Default</a> <a href="/tags/ios-ad-hoc-企业发布-发布-In-house/" style="font-size: 15px;">ios, ad-hoc, 企业发布 ,发布, In house,</a> <a href="/tags/python-flask-alchemy/" style="font-size: 15px;">python, flask, alchemy</a> <a href="/tags/python-flask-sqlalchemy-database/" style="font-size: 15px;">python, flask, sqlalchemy, database</a> <a href="/tags/python-pip-flask/" style="font-size: 15px;">python, pip, flask</a> <a href="/tags/html-css/" style="font-size: 15px;">html, css</a> <a href="/tags/flask-怎么使用virtualenv/" style="font-size: 15px;">flask, 怎么使用virtualenv</a> <a href="/tags/markdown/" style="font-size: 15px;">markdown</a> <a href="/tags/UIImage/" style="font-size: 15px;">UIImage</a> <a href="/tags/resizableImage的疑问/" style="font-size: 15px;">resizableImage的疑问</a> <a href="/tags/swift/" style="font-size: 15px;">swift</a> <a href="/tags/as/" style="font-size: 15px;">as</a> <a href="/tags/as/" style="font-size: 15px;">as?</a> <a href="/tags/as/" style="font-size: 15px;">as!</a> <a href="/tags/Optional/" style="font-size: 15px;">Optional</a> <a href="/tags/UIViewControllerBasedStatusBarAppearance/" style="font-size: 15px;">UIViewControllerBasedStatusBarAppearance</a> <a href="/tags/childViewControllerForStatusBarStyle/" style="font-size: 15px;">childViewControllerForStatusBarStyle</a> <a href="/tags/状态栏/" style="font-size: 15px;">状态栏</a> <a href="/tags/2017/" style="font-size: 15px;">2017</a> <a href="/tags/HTTP/" style="font-size: 15px;">HTTP</a> <a href="/tags/HTTPS/" style="font-size: 15px;">HTTPS</a> <a href="/tags/计算机/" style="font-size: 15px;">计算机</a> <a href="/tags/网络/" style="font-size: 15px;">网络</a> <a href="/tags/flask-sqlalchemy/" style="font-size: 15px;">flask, sqlalchemy</a> <a href="/tags/Cookie/" style="font-size: 15px;">Cookie</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/06/25/2017-6-25-StatusBarColor/">iOS状态栏颜色变更</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/24/2017-4-24-Swift_usage1/">重构代码疑问之 as? as as!</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/2017-01-21-resizableImage/">resizableImage的疑问</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/22/Http权威指南读书笔记II/">Http权威指南读书笔记II</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/21/2017-01-21-https1/">HTTP权威指南读书笔记I</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/21/Hello-2017/">Hello 2017</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/06/2015-05-06-sqlalchemy-study/">SQLAlchemy学习备份</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/06/2015-05-06-git/">git神图</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/28/2015-04-28-sqlite-query/">sqlite3的使用1-操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/28/2015-04-28-sqlite3-base/">sqlite3的使用</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://www.v2ex.com" title="v2ex" target="_blank">v2ex</a><ul></ul><a href="https://douban.fm" title="douban.fm" target="_blank">douban.fm</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">XuQ's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script>var duoshuoQuery = {short_name:'antwork'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>